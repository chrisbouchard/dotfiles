#!/usr/bin/env zsh

source $HOME/.zsh/liquidprompt/liquidprompt

function preexec {
    local CMD=${2[(wr)^(*=*|sudo|exec|command|nocorrect|noglob|-*)]}
    local CONTEXT

    if [ "$CMD" = 'fg' ] && [ -n "$jobstates" ]
    then
        CMD=$(jobs %+ | awk '{print $4}')
    fi

    if [ -z "$SSH_CONNECTION" ]
    then
        CONTEXT=$(print -P '%~')
        #printf '\033]0;%s\007' $CMD
    else
        CONTEXT=$(print -P '%m:%~')
        #printf '\033]0;%s:%s\007' $CMD $HOSTNAME
    fi

    printf '\033]0;%s (%s)\007' $CMD $CONTEXT
}

